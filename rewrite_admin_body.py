from pathlib import Path

path = Path(r"apps/web/app/admin/layout.jsx")
text = path.read_text()
needle = "const sidebarClasses = ["
if needle not in text:
    raise SystemExit('sidebarClasses marker missing')
prefix = text.split(needle, 1)[0]
replacement = "const sidebarClasses = [\n  'fixed inset-y-0 left-0 z-40 w-72 transform bg-white shadow-xl transition-transform duration-300 ease-in-out md:relative md:z-auto md:h-auto md:w-64 md:rounded-xl md:border md:border-gray-200 md:shadow-sm',\n  isMobileOpen ? 'translate-x-0' : '-translate-x-full',\n  'md:translate-x-0',\n  isPinned ? 'md:block' : 'md:hidden'\n].join(' ');\n\nconst userId = user?.id ?? user?.sub ?? null;\nconst userEmail = user?.email ?? 'admin';\n\nreturn (\n  <AdminGuard>\n    <NotificationListener userId={userId} role={user?.roles?.[0]}>\n      <div className=\"min-h-screen bg-gray-50\">\n        {isMobileOpen && (\n          <div\n            className=\"fixed inset-0 z-30 bg-black/40 backdrop-blur-sm md:hidden\"\n            role=\"presentation\"\n            aria-hidden=\"true\"\n            onClick={closeMobile}\n          />\n        )}\n\n        <div className=\"w-full px-4 md:px-8 py-6\">\n          <div className=\"flex flex-col gap-6 md:flex-row md:items-start md:gap-6\">\n            <aside\n              id=\"admin-sidebar\"\n              className={sidebarClasses}\n              aria-hidden={!isPinned && !isMobileOpen}\n            >\n              <div className=\"flex items-center justify-between border-b border-gray-200 px-4 py-4 md:block md:border-none\">\n                <div>\n                  <h2 className=\"text-lg font-semibold text-gray-900\">Admin Portal</h2>\n                  <p className=\"text-xs text-gray-500\">Signed in as {userEmail}</p>\n                </div>\n                <button\n                  ref={closeButtonRef}\n                  type=\"button\"\n                  onClick={closeMobile}\n                  className=\"md:hidden inline-flex items-center justify-center rounded-md p-2 text-gray-500 hover:text-gray-700\"\n                  aria-label=\"Close navigation\"\n                  aria-controls=\"admin-sidebar\"\n                >\n                  <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n\n              <nav className=\"space-y-1 px-3 py-4\" aria-label=\"Admin navigation\">\n                {NAV_ITEMS.map((item) => {\n                  const active = isActive(item.path);\n                  return (\n                    <Link\n                      key={item.path}\n                      href={item.path}\n                      className={`flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition-colors ${\n                        active ? 'bg-blue-50 text-blue-700' : 'text-gray-700 hover:bg-gray-100'\n                      }`}\n                      aria-current={active ? 'page' : undefined}\n                      onClick={() => {\n                        closeMobile();\n                      }}\n                    >\n                      <span className={active ? 'text-blue-600' : 'text-gray-500'}>{renderIcon(item.icon)}</span>\n                      {item.label}\n                    </Link>\n                  );\n                })}\n              </nav>\n            </aside>\n\n            <div className=\"flex-1 space-y-6\">\n              <header className=\"flex flex-col gap-4 md:flex-row md:items-center md:justify-between\">\n                <div>\n                  <p className=\"text-sm text-gray-500\">Signed in as</p>\n                  <p className=\"text-base font-medium text-gray-900\">{userEmail}</p>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={togglePinned}\n                    className=\"hidden md:inline-flex items-center gap-3 rounded-full border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-600 shadow-sm transition-colors hover:border-blue-200 hover:text-blue-600\"\n                    aria-label={isPinned ? 'Hide navigation' : 'Show navigation'}\n                    aria-pressed={!isPinned}\n                  >\n                    <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                      {isPinned ? (\n                        <>\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 5h16a1 1 0 011 1v12a1 1 0 01-1 1H4a1 1 0 01-1-1V6a1 1 0 011-1z\" />\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 4v16\" />\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M13 12l3 3m0 0l3-3m-3 3V9\" />\n                        </>\n                      ) : (\n                        <>\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 5h16a1 1 0 011 1v12a1 1 0 01-1 1H4a1 1 0 01-1-1V6a1 1 0 011-1z\" />\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M9 4v16\" />\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 12l-3-3m0 0l-3 3m3-3v6\" />\n                        </>\n                      )}\n                    </svg>\n                    <span className=\"hidden lg:inline\">{isPinned ? 'Hide navigation' : 'Show navigation'}</span>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={toggleMobile}\n                    className=\"inline-flex items-center justify-center rounded-md bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-gray-200 hover:bg-gray-50 md:hidden\"\n                    aria-label=\"Toggle navigation\"\n                    aria-expanded={isMobileOpen}\n                    aria-controls=\"admin-sidebar\"\n                  >\n                    {isMobileOpen ? (\n                      <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M4 6h16M4 12h16M4 18h16\" />\n                      </svg>\n                    )}\n                  </button>\n                </div>\n              </header>\n\n              <main className=\"rounded-xl border border-gray-200 bg-white p-6 shadow-sm\">\n                {children}\n              </main>\n            </div>\n          </div>\n        </div>\n      </div>\n    </NotificationListener>\n  </AdminGuard>\n);\n\n}\n"
text = prefix + replacement
path.write_text(text)
